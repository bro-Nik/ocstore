(()=>{"use strict";var t,e={469:(t,e,o)=>{o.d(e,{j:()=>K,X:()=>Q});var n=o(236),s=o(636);function i(){const t=document.querySelector(".swiper");if(!t)return;const e=t.querySelectorAll(".swiper-slide").length;var o=new n.A(".product_thumbs_swiper",{loop:e>4,spaceBetween:10,slidesPerView:4,freeMode:!0,watchSlidesProgress:!0});return{productThumbsSwiper:o,productMainSwiper:new n.A(".product_main_swiper",{modules:[s.Vx,s.WO],loop:!0,spaceBetween:10,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},thumbs:{swiper:o}})}}const r=function(){function t(t){var e=this;this.listener=function(t){(t.matches?e.matchFns:e.unmatchFns).forEach((function(t){t()}))},this.toggler=window.matchMedia(t),this.toggler.addListener(this.listener),this.matchFns=[],this.unmatchFns=[]}return t.prototype.add=function(t,e){this.matchFns.push(t),this.unmatchFns.push(e),(this.toggler.matches?t:e)()},t}();var a=function(t){return Array.prototype.slice.call(t)},c=function(t,e){return a((e||document).querySelectorAll(t))},u="mm-spn";const d=function(){function t(t,e,o,n,s){this.node=t,this.title=e,this.slidingSubmenus=n,this.selectedClass=o,this.node.classList.add(u),this.node.classList.add(u+"--"+s),this.node.classList.add(u+"--"+(this.slidingSubmenus?"navbar":"vertical")),this._setSelectedl(),this._initAnchors()}return Object.defineProperty(t.prototype,"prefix",{get:function(){return u},enumerable:!1,configurable:!0}),t.prototype.openPanel=function(t){var e=t.parentElement;if(this.slidingSubmenus){var o=t.dataset.mmSpnTitle;e===this.node?this.node.classList.add(u+"--main"):(this.node.classList.remove(u+"--main"),o||a(e.children).forEach((function(t){t.matches("a, span")&&(o=t.textContent)}))),o||(o=this.title),this.node.dataset.mmSpnTitle=o,c("."+u+"--open",this.node).forEach((function(t){t.classList.remove(u+"--open"),t.classList.remove(u+"--parent")})),t.classList.add(u+"--open"),t.classList.remove(u+"--parent");for(var n=t.parentElement.closest("ul");n;)n.classList.add(u+"--open"),n.classList.add(u+"--parent"),n=n.parentElement.closest("ul")}else{var s=t.matches("."+u+"--open");c("."+u+"--open",this.node).forEach((function(t){t.classList.remove(u+"--open")})),t.classList[s?"remove":"add"](u+"--open");for(var i=t.parentElement.closest("ul");i;)i.classList.add(u+"--open"),i=i.parentElement.closest("ul")}},t.prototype._setSelectedl=function(){var t=c("."+this.selectedClass,this.node),e=t[t.length-1],o=null;e&&(o=e.closest("ul")),o||(o=this.node.querySelector("ul")),this.openPanel(o)},t.prototype._initAnchors=function(){var t=this;this.node.addEventListener("click",(function(e){var o=e.target,n=!1;n=n||function(t){return!!t.matches("a")}(o),n=n||function(e){var o;return!!(o=e.closest("span")?e.parentElement:!!e.closest("li")&&e)&&(a(o.children).forEach((function(e){e.matches("ul")&&t.openPanel(e)})),!0)}(o),n=n||function(e){var o=c("."+u+"--open",e),n=o[o.length-1];if(n){var s=n.parentElement.closest("ul");if(s)return t.openPanel(s),!0}return!1}(o),n&&e.stopImmediatePropagation()}))},t}();var l="mm-ocd";const p=function(){function t(t,e){var o=this;void 0===t&&(t=null),this.wrapper=document.createElement("div"),this.wrapper.classList.add(""+l),this.wrapper.classList.add(l+"--"+e),this.content=document.createElement("div"),this.content.classList.add(l+"__content"),this.wrapper.append(this.content),this.backdrop=document.createElement("div"),this.backdrop.classList.add(l+"__backdrop"),this.wrapper.append(this.backdrop),document.body.append(this.wrapper),t&&this.content.append(t);var n=function(t){o.close(),t.stopImmediatePropagation()};this.backdrop.addEventListener("touchstart",n,{passive:!0}),this.backdrop.addEventListener("mousedown",n,{passive:!0})}return Object.defineProperty(t.prototype,"prefix",{get:function(){return l},enumerable:!1,configurable:!0}),t.prototype.open=function(){this.wrapper.classList.add(l+"--open"),document.body.classList.add(l+"-opened")},t.prototype.close=function(){this.wrapper.classList.remove(l+"--open"),document.body.classList.remove(l+"-opened")},t}();var h=function(){function t(t,e){void 0===e&&(e="all"),this.menu=t,this.toggler=new r(e)}return t.prototype.navigation=function(t){var e=this;if(!this.navigator){var o=(t=t||{}).title,n=void 0===o?"Menu":o,s=t.selectedClass,i=void 0===s?"Selected":s,r=t.slidingSubmenus,a=void 0===r||r,c=t.theme,u=void 0===c?"light":c;this.navigator=new d(this.menu,n,i,a,u),this.toggler.add((function(){return e.menu.classList.add(e.navigator.prefix)}),(function(){return e.menu.classList.remove(e.navigator.prefix)}))}return this.navigator},t.prototype.offcanvas=function(t){var e=this;if(!this.drawer){var o=(t=t||{}).position,n=void 0===o?"left":o;this.drawer=new p(null,n);var s=document.createComment("original menu location");this.menu.after(s),this.toggler.add((function(){e.drawer.content.append(e.menu)}),(function(){e.drawer.close(),s.after(e.menu)}))}return this.drawer},t}();const m=h,v=m;function f(t){const e=g("div","","text-danger");return e.textContent=t,e}window.MmenuLight=m;const g=(t,e="",o="",n={})=>{const s=document.createElement(t);return(e=e.startsWith("#")?e.slice(1):e)&&(s.id=e),(o=o.replace(".",""))&&(s.className=o),Object.entries(n).forEach((([t,e])=>s.setAttribute(t,e))),s};function y(t,e){const o=t.nextElementSibling;o&&o.classList.contains("text-danger")&&o.remove(),t.classList.add("error_style"),t.after(f(e)),t.scrollIntoView({behavior:"smooth",block:"center"})}class w{constructor(t){this.target=t}show(){const t=g("div","","masked"),e=g("div","","loading");this.target.append(t,e)}hide(){this.target.querySelectorAll(".masked, .loading").forEach((t=>t.remove()))}}const b=(t,e)=>{let o,n;return function(){const s=this,i=arguments;n?(clearTimeout(o),o=setTimeout((function(){Date.now()-n>=e&&(t.apply(s,i),n=Date.now())}),e-(Date.now()-n))):(t.apply(s,i),n=Date.now())}},_=(t,e)=>{let o;return function(){const n=this,s=arguments;clearTimeout(o),o=setTimeout((()=>{t.apply(n,s)}),e)}};const E=new class{constructor(){this.handlers=new Map}on(t,e,o,n={}){const s=n.throttle?b(o,n.throttle):n.debounce?_(o,n.debounce):o;t.addEventListener(e,s),this._storeHandler(t,e,s)}delegate(t,e,o,n,s={}){this.on(t,e,(t=>{const e=t.target.closest(o);e&&n(t,e)}),s)}off(t,e){if(!this.handlers.has(t))return;const o=this.handlers.get(t);if(o.has(e)){for(const n of o.get(e))t.removeEventListener(e,n);o.delete(e)}}offAll(t){if(!this.handlers.has(t))return;const e=this.handlers.get(t);if(!e||"object"!=typeof e)return void this.handlers.delete(t);const o=Object.keys(e);for(const n of o){const o=e[n];o&&"function"==typeof o.forEach&&o.forEach((e=>{t.removeEventListener(n,e)})),delete e[n]}this.handlers.delete(t)}_storeHandler(t,e,o){this.handlers.has(t)||this.handlers.set(t,{}),this.handlers.get(t)[e]||(this.handlers.get(t)[e]=[]),this.handlers.get(t)[e].push(o)}};const q=new class{constructor(){this.globalHandlers={}}addHandlers(t=[],e=document,o=null){Object.entries(t).forEach((([t,n])=>{E.delegate(e,"click",`[data-action="${t}"]`,((t,e)=>{o&&o[n]&&o[n].call(o,t,e)}))}))}};const S=new class{async loadHtml(t,e){if(e){const o=await fetch(t);return e.innerHTML=await o.text(),o}}async loadJson(t){return(await fetch(t)).json()}async postFormData(t,e){return fetch(t,{method:"POST",body:new URLSearchParams(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()}))}},I={};class x{constructor(t={}){this.config={...I,...t},this.selectors=this.config.selectors,this.endpoints=this.config.endpoints,this.events=this.config.events,this.dialog=null,this.content=null,this.loading=null,this.initialized=!1,this.api=S,this.init()}init(){this.initialized||(this.bindEvents(),this.initialized=!0)}bindEvents(){q.addHandlers(this.config.globalEvents,document,this)}showLoading(t){new w(t).show()}hideLoading(t){new w(t).hide()}handleError(t){console.error(`[${this.moduleName}] Error:`,t),this.dispatchEvent("error",{error:t.message})}sendFormData(t,e){return this.api.postFormData(t,e)}dispatchEvent(t,e={}){const o=new CustomEvent(`${this.config.moduleName}-events:${t}`,{detail:e,bubbles:!0,cancelable:!0});document.dispatchEvent(o)}event(t,e,o,n={}){E.delegate(document,t,e,o.bind(this),n)}getSelectors(t,e={}){return t?(t=Array.isArray(t)?t:[t]).map((t=>{let o=t;for(const[t,n]of Object.entries(e))null!=n&&(o=o.replace(new RegExp(`{${t}}`,"g"),n));return o})):[]}}const C={};class k extends x{constructor(t={}){super({...C,...t})}bindEvents(){const t=`${this.config.moduleName}-toggle`;q.addHandlers({[t]:"toggle"},document,this),super.bindEvents()}toggle(t,e,o=null){this.showLoading(e);const n=e.dataset.productId;if(!n)return;const s=e.dataset.brand;(o=null!==o?o:new FormData).append("product_id",n),s&&o.append("brand",s),this.sendFormData(this.config.endpoints.toggle,o).then((t=>this.handleToggleResponse(t,n))).catch((t=>this.handleError(t))).finally((()=>this.hideLoading(e)))}handleToggleResponse(t,e){return t.redirect?window.location.assign(t.redirect):t.error?this.showErrors(t.error):void(t.success&&(this.updateTotalCount(t.total),this.updateButtons(e),this.dispatchEvent("toggle",{productId:e,data:t})))}updateButtons(t){let e=[];e=void 0===t?[`.in-${this.config.moduleName}`]:this.getSelectors(this.selectors.btns,{product_id:t}),e.forEach((t=>{document.querySelectorAll(t).forEach((t=>{this.updateButton(t)}))}))}updateButton(t){const e=`in-${this.config.moduleName}`;t.classList.contains(e)?(t.classList.remove(e),t.setAttribute("title",this.config.titleIn||""),t.setAttribute("data-original-title",this.config.titleIn||""),t.setAttribute("data-toggle","tooltip"),t.setAttribute("data-action",`${this.config.moduleName}-toggle`),this.config.textIn&&(t.innerHTML=this.config.textIn)):(t.classList.add(e),t.setAttribute("title",this.config.titleOut||""),t.setAttribute("data-original-title",this.config.titleOut||""),t.setAttribute("data-toggle","tooltip"),t.setAttribute("data-action",this.config.actionIn||`${this.config.moduleName}-toggle`),this.config.textOut&&(t.innerHTML=this.config.textOut))}updateTotalCount(t){const e=document.querySelectorAll(`.${this.config.moduleName}-total`);e&&e.forEach((e=>{e.textContent=t}))}showErrors(t){if(t.option)for(const e in t.option){const o=document.getElementById(`input-option${e}`);if(o){const n=document.createElement("span");n.className="error bg-danger",n.textContent=t.option[e],o.parentNode.insertBefore(n,o),window.innerWidth<768&&window.scrollTo({top:n.offsetTop-40,behavior:"smooth"})}}}}const L={moduleName:"compare",endpoints:{toggle:"index.php?route=product/compare/add"},selectors:{btns:[".product-thumb.product_{product_id} .compare a",".product-info .compare.pjid_{product_id}"]}};new class extends k{constructor(){super(L)}};const A={moduleName:"wishlist",titleIn:"В закладки",titleOut:"Из закладок",endpoints:{toggle:"index.php?route=account/wishlist/add"},selectors:{btns:[".product-thumb.product_{product_id} .wishlist a",".product-info a.wishlist.pjid_{product_id}",".cart_wish a.wishlist.wishlist_wprid_{product_id}"]}};new class extends k{constructor(){super(A)}};const T={selectors:{popupId:"",popupClass:"",popupCenter:".popup-center",popupHeader:".popup-heading",tooltips:[".tooltip"],submitBtn:['[data-action="submit"]'],purchaseForm:"#purchase-form"},modalEvents:{close:"close",submit:"handleSubmit"}};class P{constructor(t={}){this.config={...T,...t,selectors:{...T.selectors,...t.selectors},modalEvents:{...T.modalEvents,...t.modalEvents},globalEvents:{...T.globalEvents,...t.globalEvents},endpoints:{...T.endpoints,...t.endpoints}},this.selectors=this.config.selectors,this.endpoints=this.config.endpoints,this.dialog=null,this.content=null,this.loading=null,this.initialized=!1,this.api=S,this.init()}init(){this.initialized||(this.createDialog(),this.bindEvents(),this.loading=new w(this.dialog),this.initialized=!0)}bindEvents(){q.addHandlers(this.config.globalEvents,document,this)}bindPopupEvents(){q.addHandlers(this.config.modalEvents,this.dialog,this)}addEvent(t,e,o,n={}){E.delegate(this.dialog,t,e,o.bind(this),n)}delEvents(){E.offAll(this.dialog)}createDialog(){this.dialog=g("dialog","",this.selectors.popupClass,{"aria-modal":"true"}),this.content=g("div",this.selectors.popupId),this.dialog.appendChild(this.content),document.body.appendChild(this.dialog)}beforeShow(){const t=document.querySelector("dialog[open]");t&&t.close(),this.loading.show(),this.hideDropdowns(),this.hideTooltips(),this.hideVisible(),document.body.classList.add("popup-open")}afterShow(){this.bindPopupEvents(),this.loading.hide()}async show(t){await this.beforeShow();const e=new CustomEvent("popup:opening",{bubbles:!0,cancelable:!0,detail:{popup:this,url:t}});if(!this.dialog.dispatchEvent(e))return;this.dialog.showModal(),"string"!=typeof t&&(t=this.endpoints.content),await this.api.loadHtml(t,this.content);const o=new CustomEvent("popup:opened",{bubbles:!0,detail:{popup:this,url:t}});this.dialog.dispatchEvent(o),await this.afterShow()}hideDropdowns(){document.querySelectorAll(this.selectors.dropdowns).forEach((t=>{t.style.display="none"}))}hideVisible(){document.querySelectorAll(".temporarily-visible").forEach((t=>{t.classList.remove("temporarily-visible")}))}hideTooltips(){document.querySelectorAll(this.selectors.tooltips).forEach((t=>{t.style.display="none"}))}cleanupAfterClose(){document.querySelectorAll(this.selectors.dropdowns).forEach((t=>{t.style.display=""})),document.body.classList.remove("popup-open")}close(t,e){this.delEvents(),this.dialog.close(),this.cleanupAfterClose()}handleErrors(t){if(this.dialog.querySelectorAll(".text-danger").forEach((t=>t.remove())),this.dialog.querySelectorAll(".error_style").forEach((t=>t.classList.remove("error_style"))),t.field)for(const[e,o]of Object.entries(t.field)){const t=this.dialog.querySelector(`[name="${e}"]`);t&&(t.classList.add("error_style"),t.after(f(o)))}if(t.option)for(const[e,o]of Object.entries(t.option)){const t=this.dialog.querySelector(`#input-option${e.replace("_","-")}`);t&&t.after(f(o))}if(t.recurring){const e=this.dialog.querySelector('select[name="recurring_id"]');e&&e.after(f(t.recurring))}if(t.z_min_sum){const e=this.dialog.querySelector(".product_max");e&&e.after(f(t.z_min_sum))}}async handleSubmit(){const t=this.dialog.querySelector(this.selectors.purchaseForm);if(function(t){let e=!0;const o=t.querySelector('input[name="telephone"]'),n=function(t){if(!t)return;const e=t.value.trim();return e||t.required?11==e.replace(/\D/g,"").length?void 0:"Введите корректный номер телефона":void 0}(o);n&&(y(o,n),e=!1);const s=t.querySelector('input[name="email"]'),i=function(t){if(!t)return;const e=t.value;return e||t.required?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?void 0:"Введите корректный Email":void 0}(s);return i&&(y(s,i),e=!1),e}(t))try{this.loading.show();const e=new FormData(t),o=await fetch(this.endpoints.submit,{method:"POST",body:e}),n=await o.json();n.error?this.handleErrors(n.error):n.output&&this.handleSuccess(n.output)}catch(t){console.error("Ошибка при оформлении заказа:",t)}finally{this.loading.hide()}}handleSuccess(t){const e=this.dialog.querySelector(this.selectors.popupCenter);e&&(e.innerHTML=t),this.removecheckoutBtn()}removecheckoutBtn(){const t=this.dialog.querySelector(this.selectors.submitBtn);t&&t.remove();const e=this.dialog.querySelector('[data-action="quick-order"]');e&&e.remove();const o=this.dialog.querySelector(".checkout-btn");o&&o.remove()}}const O={endpoints:{cartInfo:"index.php?route=common/cart/info"},selectors:{quantityInput:".plus-minus",productIdInput:'input[name="product_id"]',quantityPlus:".btn-plus button",quantityMinus:".btn-minus button",quantityContainer:".number",removeButton:".remove button",cartItems:"#cart > ul"}};class F extends P{constructor(t={}){super({...O,...t,selectors:{...O.selectors,...t.selectors},modalEvents:{...O.modalEvents,...t.modalEvents},globalEvents:{...O.globalEvents,...t.globalEvents},endpoints:{...O.endpoints,...t.endpoints}})}bindPopupEvents(){super.bindPopupEvents(),this.addEvent("click",this.selectors.quantityPlus,this.quantityChange),this.addEvent("click",this.selectors.quantityMinus,this.quantityChange),this.addEvent("change",this.selectors.quantityInput,this.quantityChangeManual),this.addEvent("keyup",this.selectors.quantityInput,this.quantityChangeManual),this.addEvent("click",this.selectors.removeButton,this.removeItem)}async quantityChange(t,e){const o=e.closest(this.selectors.quantityPlus)?"increase":"decrease",n=e.closest(this.selectors.quantityContainer),s=n.querySelector(this.selectors.quantityInput),i=n.querySelector(this.selectors.productIdInput).value;let r=parseInt(s.value);r="increase"===o?r+1:r-1,r<1&&(r=1),s.value=r,await this.updateCartItem(i,r)}async quantityChangeManual(t,e){e.value=e.value.replace(/[^\d]/g,"");const o=parseInt(e.value)||1,n=e.closest("tr, .mobile-products-cart > div").querySelector(this.selectors.productIdInput).value;e.value&&await this.updateCartItem(n,o)}async removeItem(t,e){const o=e.nextElementSibling.value;await this.updateCartItem(o,0),H.updateButtons(o)}async updateCartItem(t){this.loading.show();try{await this.api.loadHtml(t,this.content),this.updateCartStatus()}finally{this.loading.hide()}}async updateCartStatus(){try{const t=await this.api.loadJson(this.endpoints.cartStatus);if(t.total){H.updateTotalCount(t.total),"0"===t.total&&(this.removecheckoutBtn(),H.updateButtons());const e=document.querySelector(this.selectors.cartItems);await this.api.loadHtml(this.endpoints.cartInfo,e)}}catch(t){console.error("Ошибка при обновлении статуса корзины:",t)}}handleSuccess(t){super.handleSuccess(t),this.updateCartStatus()}}const M={selectors:{popupId:"#popup-cart"},endpoints:{content:"index.php?route=revolution/revpopupcart",cartStatus:"index.php?route=revolution/revpopupcart/status_cart"},globalEvents:{"open-popup-cart":"show"}};const D=new class extends F{constructor(){super(M)}async updateCartItem(t,e){const o=`${this.endpoints.content}&update=${t}&quantity=${e}`;super.updateCartItem(o)}},B={moduleName:"cart",textIn:"Купить",titleIn:"Добавить в корзину",textOut:"В корзине",titleOut:"Перейти в корзину",actionIn:"open-popup-cart",endpoints:{toggle:"index.php?route=checkout/cart/add",edit:"index.php?route=checkout/cart/edit",info:"index.php?route=common/cart/info"},selectors:{removeButton:".remove button",quantityInput:"#revcart_upd .plus-minus",productIdInput:'#revcart_upd input[name="product_id"]',quantityPlus:"#revcart_upd .btn-plus button",quantityMinus:"#revcart_upd .btn-minus button",quantityContainer:"#revcart_upd .number",cartContent:".rev_cart",btns:[".product-thumb.product_{product_id} .btn-cart",".product-info .btn-cart",".quickview .btn-cart.pjid_{product_id}"],forms:{catalog:".products_category .product_{product_id} .options",catalog_mod:".products_category_mod .product_{product_id} .options",product:".product_informationss.product-info",popup_product:"#popup-view-wrapper .product-info",module:"#{block_id} .product_{product_id} .options"},cartItems:"#cart > ul"},globalEvents:{update_prices_product:"updatePricesProduct"}};const H=new class extends k{constructor(){super(B)}bindEvents(){super.bindEvents(),E.delegate(document,"click",this.selectors.quantityPlus,this.quantityChange.bind(this)),E.delegate(document,"click",this.selectors.quantityMinus,this.quantityChange.bind(this)),E.delegate(document,"change",this.selectors.quantityInput,this.quantityChangeManual.bind(this)),E.delegate(document,"keyup",this.selectors.quantityInput,this.quantityChangeManual.bind(this))}toggle(t,e){const o=e.dataset.productId;if(!o)return;const n=e.dataset.module||"product",s=e.dataset.productMinimum||1,i=e.dataset.blockId||null,r=this.getFormElements(o,n,i),a=this.buildFormData(r,o,s);super.toggle(t,e,a)}getFormSelectors(t,e,o){switch(t){case"catalog":return this.getSelectors(this.selectors.forms.catalog,{product_id:e});case"catalog_mod":return this.getSelectors(this.selectors.forms.catalog_mod,{product_id:e});case"product":return this.getSelectors(this.selectors.forms.product,{product_id:e});case"popup_product":return this.getSelectors(this.selectors.forms.popup_product,{product_id:e});case"module":case"module_in_product":return this.getSelectors(this.selectors.forms.module,{product_id:e,block_id:o});default:return[]}}getFormElements(t,e,o){return this.getFormSelectors(e,t,o).flatMap((t=>['input[type="text"]','input[type="hidden"]','input[type="radio"]:checked','input[type="checkbox"]:checked',"select",..."product"===e||"popup_product"===e?["textarea"]:[]].flatMap((e=>Array.from(document.querySelectorAll(`${t} ${e}`)))).filter(Boolean))).filter(Boolean)}buildFormData(t,e,o){const n=new FormData;return n.append("product_id",e),n.append("quantity",o),t.forEach((t=>{"checkbox"===t.type||"radio"===t.type?t.checked&&n.append(t.name,t.value):"SELECT"===t.tagName&&t.multiple?Array.from(t.selectedOptions).forEach((e=>{n.append(`${t.name}[]`,e.value)})):n.append(t.name,t.value)})),n}handleToggleResponse(t,e){super.handleToggleResponse(t,e),this.updateCart(t),D.show()}updateCart(t){const e=document.querySelector(this.selectors.cartItems);this.api.loadHtml(this.config.endpoints.info,e)}async quantityChange(t,e){const o=document.querySelector("#revcart_upd");this.showLoading(o);const n=e.closest(this.selectors.quantityPlus)?"increase":"decrease",s=e.closest(this.selectors.quantityContainer),i=s.querySelector(this.selectors.quantityInput),r=s.querySelector(this.selectors.productIdInput).value;let a=parseInt(i.value);a="increase"===n?a+1:a-1,a<1&&(a=1),i.value=a,await this.update(r,a),this.hideLoading(o)}async quantityChangeManual(t,e){e.value=e.value.replace(/[^\d]/g,"");const o=parseInt(e.value)||1,n=e.closest("tr, .mobile-products-cart > div").querySelector(this.selectors.productIdInput).value;e.value&&await this.update(n,o)}updatePricesProduct(t,e){const o=e.closest("dialog")||document.querySelector(".product-info.product_informationss");this.showLoading(o);var n=0,s=0,i=null;const r=e.closest("form");r?(n=r.querySelector('input[name="product_id"]').value,s=r.querySelector('input[name="quantity"]').value,i=document.querySelector("#popup-purchase")):(n=e.dataset.productId,s=e.dataset.productMinimum||1,i=o);const a=i.querySelectorAll('\n      .product-info.product_informationss input[type="text"],\n      .product-info.product_informationss input[type="hidden"],\n      .product-info.product_informationss input[type="radio"]:checked,\n      .product-info.product_informationss input[type="checkbox"]:checked,\n      .product-info.product_informationss select,\n      .product-info.product_informationss textarea\n    '),c=new FormData;a.forEach((t=>{t.name&&c.append(t.name,t.value)})),c.append("product_id",n),c.append("quantity",s),fetch("index.php?route=product/product/update_prices",{method:"POST",body:c}).then((t=>t.json())).then((t=>{i.querySelectorAll(".product_informationss .pr_quantity").forEach((e=>{e.textContent=K(t.option_quantity,product_id)})),i.querySelectorAll(".product_informationss .pr_points").forEach((e=>{e.textContent=number_Format(t.points,product_id)})),i.querySelectorAll(".product_informationss .pr_model").forEach((e=>{e.textContent=t.opt_model})),i.querySelectorAll(".update_price, .update_special").forEach((e=>{e.textContent=Q(t.special_n)})),this.hideLoading(o)})).catch((t=>console.error("Ошибка:",t)))}async updateOptionsBuy(t,e,o){const n=document.querySelector(`.product-info.product_informationss .options_buy .pro_${o} input[name="option[${e}]"]`);n&&(n.value=o);const s=document.querySelectorAll(`\n      .product-info.product_informationss .options_buy .pro_${o} input[type="text"],\n      .product-info.product_informationss .options_buy .pro_${o} input[type="hidden"],\n      .product-info.product_informationss .options_buy .pro_${o} input[type="radio"]:checked,\n      .product-info.product_informationss .options_buy .pro_${o} input[type="checkbox"]:checked,\n      .product-info.product_informationss .options_buy .pro_${o} select,\n      .product-info.product_informationss .options_buy .pro_${o} textarea`),i=new FormData;s.forEach((t=>{t.name&&i.append(t.name,t.value)})),i.append("product_id",t);const r=await this.api.postFormData("index.php?route=product/product/update_prices",i);document.querySelectorAll(".product_informationss .pr_quantity").forEach((e=>{e.textContent=number_format(r.option_quantity,t)})),document.querySelectorAll(".product_informationss .pr_points").forEach((e=>{e.textContent=number_format(r.points,t)})),document.querySelectorAll(".product_informationss .pr_model").forEach((t=>{t.textContent=r.opt_model}))}async update(t,e){const o=new FormData;o.append(`quantity[${t}]`,e);await this.api.postFormData("index.php?route=revolution/revcheckout/cart_edit",o);this.updateCartSection("#top3 #cart"),this.updateCartSection("#top2 #cart"),"function"==typeof update_checkout&&cart_update()}updateCartSection(t){const e=document.querySelector(t);e&&fetch("index.php?route=common/cart/info").then((t=>t.text())).then((t=>{const o=document.createElement("div");o.innerHTML=t;const n=o.querySelector("#cart");n&&(e.innerHTML=n.innerHTML)})).catch((e=>{console.error(`Error updating ${t}:`,e)}))}},N={endpoints:{content:"index.php?route=revolution/revpopupcartquick",submit:"index.php?route=revolution/revpopupcartquick/make_order",cartStatus:"index.php?route=revolution/revpopupcartquick/status_cart"},selectors:{popupId:"#popup-cart-quick"},globalEvents:{"quick-order":"show"}};new class extends F{constructor(){super(N)}async updateCartItem(t,e){const o=`${this.endpoints.content}&update=${t}&quantity=${e}`;super.updateCartItem(o)}};const z={selectors:{popupId:"#popup-phone"},endpoints:{content:"index.php?route=revolution/revpopupphone",submit:"index.php?route=revolution/revpopupphone/make_order_phone"},globalEvents:{"open-popup-call":"show"}};new class extends P{constructor(){super(z)}};const j={selectors:{popupId:"#popup-purchase"},endpoints:{content:"index.php?route=revolution/revpopuporder&revproduct_id=",submit:"index.php?route=revolution/revpopuporder/make_order",update:"index.php?route=product/product/update_prices"},globalEvents:{purchase:"show"}};new class extends F{constructor(){super(j)}async quantityChange(t,e){const o=e.closest(this.selectors.quantityPlus)?"increase":"decrease",n=e.closest(this.selectors.quantityContainer),s=n.querySelector(this.selectors.quantityInput);n.querySelector(this.selectors.productIdInput).value;let i=parseInt(s.value);i="increase"===o?i+1:i-1,i<1&&(i=1),s.value=i,H.updatePricesProduct(t,e)}async quantityChangeManual(t,e){e.value=e.value.replace(/[^\d]/g,"");parseInt(e.value),e.closest("tr, .mobile-products-cart > div").querySelector(this.selectors.productIdInput).value;e.value&&await H.updatePricesProduct(t,e)}show(t,e){const o=e.dataset.productId||"",n=`${this.endpoints.content}${o}`;super.show(n)}};const R={selectors:{popupId:"#popup-predzakaz"},endpoints:{content:"index.php?route=revolution/revpopuppredzakaz&revproduct_id=",submit:"index.php?route=revolution/revpopuppredzakaz/make_order_notify"},globalEvents:{predzakaz:"show"}};new class extends P{constructor(){super(R)}show(t,e){const o=e.dataset.productId||"";this.zakazType=e.getAttribute("title")||e.getAttribute("data-original-title")||"";const n=`${this.endpoints.content}${o}`;super.show(n)}afterShow(){this.dialog.querySelector(this.selectors.popupHeader).innerHTML=this.zakazType,super.afterShow()}};const V={selectors:{popupId:"#popup-quick-view",popupClass:".big-dialog"},endpoints:{content:"index.php?route=revolution/revpopupview&revproduct_id="},globalEvents:{"quick-view":"show"}};new class extends P{constructor(){super(V)}show(t,e){const o=e.dataset.productId||"",n=`${this.endpoints.content}${o}`;super.show(n)}async updateCartItem(t,e){const o=`${this.endpoints.content}&update=${t}&quantity=${e}`;super.updateCartItem(o)}afterShow(){super.afterShow();const t=document.querySelector(".nav.nav-tabs li:first-child a");t&&t.click(),i()}};const W={moduleName:"review",endpoints:{load:"index.php?route=product/product/review&product_id=",writeReview:"index.php?route=product/product/write&product_id=",writeAnswer:"index.php?route=revolution/revstorereview/writeanswer&product_id="},selectors:{reviewContainer:"#review",reviewForm:".form-review",answerForm:".form-answers",pagination:".pagination a",reviewButton:"#button-review",answerButton:"#button-answers"}};new class extends x{constructor(){super(W),this.productId=null,this.container=null}bindEvents(){document.addEventListener("DOMContentLoaded",(()=>this.loadReviews())),document.addEventListener("click",this.handleClick.bind(this)),document.addEventListener("popup:opened",(t=>this.loadReviews()))}handleClick(t){const e=t.target.closest(this.selectors.pagination);return e&&this.container?(t.preventDefault(),void this.fadeOutAndLoad(e.href)):t.target.closest(this.selectors.reviewButton)?(t.preventDefault(),void this.submitReview()):void(t.target.closest(this.selectors.answerButton)&&(t.preventDefault(),this.submitAnswer()))}async fadeOutAndLoad(t){try{this.container.style.opacity="0",this.container.style.transition="opacity 0.3s ease",await new Promise((t=>setTimeout(t,300))),await this.loadContent(t),this.container.style.opacity="1"}catch(t){console.error("Ошибка при загрузке контента:",t),this.container.style.opacity="1",this.showNotification("alert-danger","Не удалось загрузить отзывы")}}async loadContent(t){try{const e=await fetch(t);if(!e.ok)throw new Error("Network response was not ok");const o=await e.text();this.container&&(this.container.innerHTML=o,this.container=document.querySelector(this.selectors.reviewContainer))}catch(t){throw console.error("Ошибка загрузки:",t),t}}loadReviews(t){if(this.container=document.querySelector(this.selectors.reviewContainer),!this.container)return;this.productId=this.container.dataset.productId;const e=`${this.config.endpoints.load}${this.productId}`;this.loadContent(e)}async submitForm(t,e){const o=document.querySelector(t),n=document.querySelector(`${t} [type="submit"]`);if(o&&n)try{n.disabled=!0;const s=new FormData(o);s.append("product_id",this.productId);const i=await fetch(e,{method:"POST",body:new URLSearchParams(s)});if(!i.ok)throw new Error("Network response was not ok");this.clearNotifications();const r=await i.json();r.error&&this.showNotification("alert-danger",r.error),r.success&&(this.showNotification("alert-success",r.success),this.resetForm(t))}catch(t){console.error("Ошибка:",t),this.showNotification("alert-danger","Произошла ошибка при отправке")}finally{n.disabled=!1}}async submitReview(){await this.submitForm(this.selectors.reviewForm,`${this.config.endpoints.writeReview}${this.productId}`)}async submitAnswer(){await this.submitForm(this.selectors.answerForm,`${this.config.endpoints.writeAnswer}${this.productId}`)}clearNotifications(){document.querySelectorAll(".alert-success, .alert-danger").forEach((t=>t.remove()))}showNotification(t,e){if(!this.container)return;const o=document.createElement("div");o.className=`alert ${t} alert-dismissible`,o.innerHTML=`\n      <button type="button" class="close" data-dismiss="alert" aria-label="Close">\n        <span aria-hidden="true">&times;</span>\n      </button>\n      ${e}\n    `,this.container.insertBefore(o,this.container.querySelector("form"));const n=setTimeout((()=>{o.style.opacity="0",o.style.transition="opacity 0.5s ease",setTimeout((()=>o.remove()),150)}),5e3);o.querySelector(".close").addEventListener("click",(()=>{clearTimeout(n),o.remove()}))}resetForm(t){const e=document.querySelector(t);if(!e)return;e.reset();e.querySelectorAll(".stars .glyphicon").forEach((t=>{t.classList.remove("glyphicon-star"),t.classList.add("glyphicon-star-empty")}));const o=e.querySelector("input, textarea, select");o&&o.focus()}};new class{constructor(t={}){this.initialized=!1,this.init()}init(){this.initialized||(this.bindEvents(),this.initialized=!0)}addEvent(t,e,o,n={}){E.delegate(document,t,e,o.bind(this),n)}bindEvents(){this.addEvent("click","[data-show-target]",this.showTarget)}showTarget(t,e){t.preventDefault();const o=e.getAttribute("data-show-target"),n=document.querySelector(o);n&&n.classList.toggle("temporarily-visible")}};var J,U,X;function Y(){document.documentElement.classList.add("visible"),setTimeout((()=>{const t=document.getElementById("preload-css");t&&t.remove()}),300)}i(),new n.A("#revslideshow",{slidesPerView:"auto",spaceBetween:10,breakpoints:{400:{slidesPerView:"auto",spaceBetween:10},0:{slidesPerView:1}}}),function(){const t={};document.querySelectorAll(".swiper-carousel").forEach(((e,o)=>{const s={slidesPerView:"auto",freeMode:!0,spaceBetween:10},i={autoplay:!!e.dataset.autoplay&&{delay:parseInt(e.dataset.autoplay),disableOnInteraction:!1},slidesPerView:e.dataset.slides?parseInt(e.dataset.slides):s.slidesPerView},r=JSON.parse(e.dataset.swiperConfig||"{}");t[`swiper${o}`]=new n.A(e,{...s,...i,...r})}))}(),(J=new v(document.querySelector("#mobil_mmenu"),"all")).navigation({title:"Меню"}),U=J.offcanvas({}),(X=document.querySelector('a[href="#mobil_mmenu"]'))&&X.addEventListener("click",(function(t){t.preventDefault(),U.open()})),document.addEventListener("DOMContentLoaded",(()=>{const t=document.querySelector(".nav.nav-tabs li:first-child a");t&&t.click();const e=document.querySelector('input[name="site_url"]');e&&(e.value=window.location.href),Y(),document.addEventListener("input",(t=>{var e;t.target.matches('input[data-validate="number"]')&&((e=t.target).value=e.value.replace(/[^\d,]/g,"")),t.target.matches('input[data-validate="telephone"]')&&function(t){t.value=t.value.replace(/[^\d,]/g,""),t.value.startsWith("7")||t.value.startsWith("8")||(t.value="7"+t.value);let e="+7";t.value.length>1&&(e+=" ("+t.value.substring(1,4)),t.value.length>3&&(e+=") "+t.value.substring(4,7)),t.value.length>7&&(e+="-"+t.value.substring(7,9)),t.value.length>9&&(e+="-"+t.value.substring(9,11)),t.value=e}(t.target)}))})),setTimeout(Y,3e3);$("#top3").outerHeight();localStorage.getItem("display")||localStorage.setItem("display","grid"),document.addEventListener("scroll",(function(){document.querySelector(".btn-scroll-top").classList.toggle("show",window.scrollY>100)}));const G=document.querySelector(".btn-scroll-top");function K(t){return parseInt(Math.abs(t).toFixed(0))+""}function Q(t){let e=parseInt(Math.abs(t))+"",o=e.length>3?e.length%3:0;return(o?e.substr(0,o)+"":"")+e.substr(o).replace(/(\d{3})(?=\d)/g,"$1")+"₽"}G&&G.addEventListener("click",(function(){window.scrollTo({top:0,behavior:"smooth"})}));const Z=document.querySelector(".footer-category"),tt=document.querySelector(".page_description");tt&&Z?.appendChild(tt),document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".page_description").forEach((t=>{const e=t.querySelector(".description"),o=document.createElement("div");o.className="description-fade";const n=document.createElement("button");n.className="toggle-btn",n.type="button",e.appendChild(o),t.appendChild(n);e.scrollHeight>e.clientHeight+5?n.addEventListener("click",(function(){e.classList.toggle("expanded")})):(o.remove(),n.remove(),e.style.maxHeight="none")}))}))},814:()=>{}},o={};function n(t){var s=o[t];if(void 0!==s)return s.exports;var i=o[t]={exports:{}};return e[t](i,i.exports,n),i.exports}n.m=e,t=[],n.O=(e,o,s,i)=>{if(!o){var r=1/0;for(d=0;d<t.length;d++){for(var[o,s,i]=t[d],a=!0,c=0;c<o.length;c++)(!1&i||r>=i)&&Object.keys(n.O).every((t=>n.O[t](o[c])))?o.splice(c--,1):(a=!1,i<r&&(r=i));if(a){t.splice(d--,1);var u=s();void 0!==u&&(e=u)}}return e}i=i||0;for(var d=t.length;d>0&&t[d-1][2]>i;d--)t[d]=t[d-1];t[d]=[o,s,i]},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={792:0};n.O.j=e=>0===t[e];var e=(e,o)=>{var s,i,[r,a,c]=o,u=0;if(r.some((e=>0!==t[e]))){for(s in a)n.o(a,s)&&(n.m[s]=a[s]);if(c)var d=c(n)}for(e&&e(o);u<r.length;u++)i=r[u],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(d)},o=self.webpackChunkclimkey_3039=self.webpackChunkclimkey_3039||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))})(),n.O(void 0,[11],(()=>n(469)));var s=n.O(void 0,[11],(()=>n(814)));s=n.O(s)})();